<!DOCTYPE HTML>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>eNGE</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

</head>
<body onload="init();">

  <!-- Canvas principal -->
  <canvas id="display"></canvas>

  <!-- Botão de configuração -->
  <button id="settingsButton" type="button">
    <img src="images/ic_controller_m1_button.png" alt="Configurações" width="30">
  </button>
<!-- Gamepad virtual -->
<div id="virtualGamepad" aria-hidden="false">
  <!-- D-pad -->
  <button id="up"><img src="images/ic_controller_up_button.png" alt="Up"></button>
  <button id="down"><img src="images/ic_controller_down_button.png" alt="Down"></button>
  <button id="left"><img src="images/ic_controller_left_button.png" alt="Left"></button>
  <button id="right"><img src="images/ic_controller_right_button.png" alt="Right"></button>

  <!-- Center -->
  <button id="select" class="small"><img src="images/ic_controller_select_button.png" alt="Select"></button>
  <button id="start" class="small"><img src="images/ic_controller_start_button.png" alt="Start"></button>

  <!-- Action buttons -->
  <button id="square"><img src="images/ic_controller_square_button.png" alt="Square"></button>
  <button id="triangle"><img src="images/ic_controller_triangle_button.png" alt="Triangle"></button>
  <button id="circle"><img src="images/ic_controller_circle_button.png" alt="Circle"></button>
  <button id="cross"><img src="images/ic_controller_cross_button.png" alt="Cross"></button>

  <!-- Shoulders -->
  <button id="l1" class="small"><img src="images/ic_controller_l1_button.png" alt="L1"></button>
  <button id="l2" class="small"><img src="images/ic_controller_l2_button.png" alt="L2"></button>
  <button id="r1" class="small"><img src="images/ic_controller_r1_button.png" alt="R1"></button>
  <button id="r2" class="small"><img src="images/ic_controller_r2_button.png" alt="R2"></button>

  <!-- Analógicos -->
  <button id="l3" class="small"><img src="images/ic_controller_l3_button.png" alt="L3"></button>
  <button id="r3" class="small"><img src="images/ic_controller_r3_button.png" alt="R3"></button>
</div>
  <!-- Log console -->
  <textarea id="logConsole" readonly></textarea>

  <!-- Modal BIOS/Game -->
  <div class="modal fade" id="settingsModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content p-3">
      <h5>Selecionar BIOS / Game / Arquivo do Sistema</h5>
      
      <div id="file">
        <label for="file-upload" class="custom-file-upload modal-btn">
          <i class="fas fa-file-upload"></i> Carregar Arquivo
        </label>
        <input id="file-upload" type="file" style="display:none;" />
      </div>

      <button id="fullscreenBtn" class="modal-btn">
        <i class="fas fa-expand"></i> Tela Cheia
      </button>
<div id="biosNotification" class="bios-notification"></div>
    </div>
  </div>
</div>

  <!-- Scripts -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gpu.js/2.12.0/gpu.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/eruda@3.0.0/eruda.min.js"></script>

  <script>
    if (window.WebGPUShader && typeof window.WebGPUShader.setScale !== "function") {
      window.WebGPUShader.setScale = function(scale = 1.0) {
        console.log("[Fallback] setScale ignorado. Escala:", scale);
      };
    }
    window.FORCE_WEBGL2 = true;
  </script>
  <script src="js/module/biosinject.js"></script>
  <script src="js/module/index.js"></script>
<script src="js/overclock.js"></script>
  <script src="js/sound.js"></script>
  <script src="js/toolgame.js"></script>
  <script src="js/webgpu-shader.js"></script>
  <script src="js/module/virtualpad.js"></script>
  <script src="js/ngine-adapter.js"></script>
  <script src="js/performance-boost.js"></script>
  <script src="js/logcast.js"></script>

  <script>
    (async () => {
      const canvas = document.getElementById('display');
      try {
        const mode = await window.WebGPUShader.init(canvas);
        console.log('Renderer initialized:', mode);
        window.WebGPUShader.setScale('nearest');
      } catch (e) {
        console.error('Renderer init failed:', e);
      }
    })();
  </script>
<script>
  const settingsButton = document.getElementById('settingsButton');
  const settingsModalEl = document.getElementById('settingsModal');

  if (settingsButton && settingsModalEl && window.bootstrap) {
    const modal = new bootstrap.Modal(settingsModalEl);
    settingsButton.addEventListener('click', () => modal.show());
  } else if (settingsButton) {
    settingsButton.addEventListener('click', () => alert('Modal não disponível (Bootstrap ausente)'));
  }
</script>

<script>
const btn = document.getElementById('fullscreenBtn');

btn.addEventListener('click', () => {
  const elem = document.documentElement; // toda a página
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.webkitRequestFullscreen) { // Safari
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) { // IE11
    elem.msRequestFullscreen();
  }
});
</script>


  
</body>
</html>